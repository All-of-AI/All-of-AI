## 计算广告1 计算广告概述

### 1.1 在线广告综述

在线广告，也称网络广告、互联网广告，指**在线媒体上投放的广告**。与传统广告不同的是，在线广告在其短短十几年的发展过程中，已经形成了**以人群为投放目标、以产品为导向的技术型投放模式**。它不仅为广告主带来了以准确接触目标受众为方法论的全新营销渠道，也为互联网免费产品和媒体找到了规模化变现的手段。不夸张地说，在过去相当长的一个时期内，**大数据这一方法论唯一形成规模化营收的落地行业就是在线广告**。

#### 1.1.1 免费模式与互联网核心资产

互联网产品的网站、应用等软件产品，往往以免费的形式服务用户；另外一些互联网公司也在以直接利润微薄甚至亏损的情况下，出售手机、电视等硬件产品。无论是软件的免费，还是硬件的低价销售，都可以成为免费模式。免费模式的本质是将那些能够规模化、个性化传播信息的商品，以**边际成本**的价格出售。

软件的边际成本很小，因此这些产品都不收费，这是狭义的免费；而手机等硬件产品，边际成本即是量产成本，因此以毛利为零左右的价格出售，这是广义的免费。这些产品的共同特点是能够传播信息，并且能够对不同用户个性化地传播信息。**产品本身没有利润**，但是这类免费产品在传播信息的过程中，获得了**三项可变现的核心资产：流量、数据和影响力**。

(1) **流量**：流量的价值是，当有人使用你的产品时，你便可以在产品本身的功能之外夹带一些**付费内容(sponsored content)**，或者称为广告，这样就把流量变成了收入。

(2) **数据**：可以根据用户留下的行为和属性调整投放付费内容的策略以提高效率。

(3) **影响力**：你的产品或内容获得了高于普通水准的关注与信任，则投放的付费内容也就获得了更好的关注效果。

值得注意的是，近年来迅速崛起的大量**网红和自媒体**，实际上主要**靠影响力而非流量和数据变现**。若将公众号软文(影响力变现)标价与文末展示广告(流量和数据变现)收入进行对比，前者的价格往往是后者的数十倍。

这三项资产通过商业产品的形式转变成收入的过程，即**商业化(monetization)**过程，与用户使用免费产品的过程是分离的，因此称为后向变现。可以看出，无论是数据变现还是影响力变现，**都是建立在流量变现的基础上的**，而这样的体系也就是计算广告技术所支撑的、现代的商业化产品体系。

#### 1.1.2 大数据与广告的关系

计算广告是在以往相当长的一段时间里唯一得到充分商业化和规模化的大数据应用。

(1) 计算广告为规模化变现流量和数据提供了完整解决方案，并创造了互联网大部分利润。

(2) 计算广告孵化了较成熟的数据加工和交易产业链。

(3) 由于存在商业上的限制条件，计算广告产品和技术比推荐系统更加复杂。因此，理解其产品和时长对于设计高效的商业产品大有益处。

#### 1.1.3 广告的定义与目的

William F. Arens在《当代广告学》中给出关于广告的定义：**广告是由已确定的出资人通过各种媒介进行的有关产品(商品、服务和观点)的，通常是有偿的、有组织的、综合的、劝服性的非人员的信息传播活动**。

广告活动的两个主动参与方分别是**出资人(sponsor)和媒体(medium)**。在数字广告复杂的市场结构中，可以用一般性的术语来描述它们：**需求方(demand)和供给方(supply)**。前者可以是**广告主(advertiser)**、代表广告主利益的**代理商(agency)**或其他技术形态的采买方；后者可以是**媒体**，也可以是其他技术形态的**变现平台**。

传统广告的本质目的主要是借助媒体的力量来快速接触大量用户，以达到宣传品牌形象，提升中长期购买率与利润空间的目的。这种目的的广告称为**品牌广告(brand awareness)**。也有许多广告商希望能利用广告手段马上带来大量的购买或其他转化行为，这种目的的广告称为**直接效果广告(direct response)**，简称为效果广告。在线广告兼有品牌和效果两方面的功能。不过，互联网广告行业的高速发展主要是因为效果广告市场带来的巨大红利。

广告的根本目的是**广告主通过媒体达到低成本的用户接触**，即按某种市场意图接触相应的人群，进而影响潜在用户，使他们选择某产品的概率增加。**短期转化效果并不是广告的目的**。

任何广告的本质都是**付费的信息推广**。

#### 1.1.4 在线广告的表现形式

在线广告的主要形式有如下几种：横幅广告(banner ad)、文字链广告(textual ad)、富媒体广告(rich media ad)、视频广告(video ad)、交互式广告(playable ad)、社交广告(social ad)、邮件营销广告(email direct marketing, EDM)、激励广告(incentive ad)、团购(**团购本质上是一种按效果付费的泛广告产品**，其本质也是一种**激励性广告**)、游戏联运、固定位导航。

以上介绍的各种广告形式概念上有交叠，并不是并列的关系。

#### 1.1.5 在线广告简史

在20世纪末，那时的在线媒体(如Yahoo)刚刚产生不久。它们的流量规模很大，投资人希望通过这些媒体产生利益。要对这些线上流量进行变现，或者称为商业化，最直接的方法就是把网站页面当成杂志版面，在里面插入广告位。这种在互联网上展示横幅广告的产品形式为**展示广告(display advertising)**，展示广告的售卖模式称为**合约广告(agreement-based advertising)**，即采用合同的方式约定某一广告位在某一时间段为特定广告主所独占，并根据双方要求，制定广告创意和投放策略。例如，**一个广告位一天的售价可以是10000元**。显然，这样的采买模式并没有用到数字媒体可以对不同用户投放不同内容的个性化特征。

数字媒体不同于传统媒体的本质特点就是可以对不同的受众呈现不同的广告创意。比如剃须刀只展示给男性，化妆品只展示给女性。这种方式称为**定向广告(targeted advertising)**。很显然，定向广告系统对计算技术提出了两个需求：一是**受众定向(audience targeting)**，二是**广告投放(ad serving)**。

展示广告领域定向投放的最初动机，是媒体为了拆分流量以获得更高的营收。但是如果提供非常精细的定向，反而会造成售卖率的下降。因此，最初的定向往往是**人口属性**等粒度较粗的标签。不过，精细受众定向显然更符合需求方的口味和利益。广告市场的钱全部是来自需求方的，他们的利益被满足得越好，市场的规模就会越大。因此，受众定向产生以后，有两方面的发展趋势：(1) **定向标签变得越来越精准**；(2) **广告主的数量不断膨胀**。在这些趋势下，按照合约方式售卖广告遇到了越来越多的麻烦：首先，很难对这些细粒度的标签组合的流量做准确预估；其次，当一次展示同时满足多个合约的时候，仅按照在线分配原则，有可能浪费了部分本可以卖得更贵的流量。这样的思路催生了计算广告历史上革命性的产品模式，**竞价广告(auction-based advertising)**。在竞价广告模式下，供给方只向广告主保证质即单位流量的成本，但不再给出量的保证。对每一次展示，则按照收益最高这样简单的原则来决策。

竞价广告产生的最初场景，是在互联网广告最主要的金矿**搜索广告(search ad)**中。与门户网站不同，搜索引擎从一开始就没有被当做媒体来看待，因此搜索流量的变现也采用了**付费搜索(paid search)**模式。从广告的视角来看，付费搜索显然也是一种定向广告，即根据用户即时兴趣定向投送的广告，而即时u的标签就是关键词。搜索广告从一开始就直接达到了非常精准的程度，也就很自然地采用了竞价的售卖方式。

### 1.2 计算广告基础

#### 1.2.1 广告有效性原理

广告的信息接收过程分为三个大的阶段，即**选择(selection)、解释(interpretation)与态度(attitude)**，或者进一步分解为六个子阶段，即**曝光(exposure)、关注(attention)、理解(comprehension)、接受(acceptance)、保持(retention)与决策(decision)**。

(1) 曝光阶段：指广告物理上展现出来的过程，其有效程度往往与广告位的物理属性有关，并没有太多可以通过技术优化的空间。实际中，曝光的有效性对最终结果的影响往往高于其他技术性因素，所以才会有**位置为王**的说法。

(2) 关注阶段：指受众从物理上接触到广告。实际上，强曝光并不能等同于用户实际有效的关注。如何提高关注阶段的效率呢？首先，尽量**不要打断用户的任务**，因为用户识别出广告位以后，认为它和当前页面不再有关联，就会下意识地屏蔽其内容；其次，明确传达向用户推送此广告的**原因**；最后，内容符合用户的**兴趣或需求**。

(3) 理解阶段：指的是使用户理解广告传达的信息。为了提高理解阶段的效率，首先，广告内容要在用户能理解的具体兴趣范围内；其次，要注意设定与关注程度相匹配的**理解门槛**。

(4) 接受阶段：受众理解了广告传达的信息，并不表示它认可这些信息。广告领域的**许多广告展示起到了负面效果**。广告的上下文环境对广告的接受程度有着很大的影响，同一个广告出现在游戏社区中合门户网站首页上，用户会倾向于认为后者更有说服力。

(5) 保持阶段：对于追求长期效果的品牌广告商，广告的**印象(艺术性、浪漫气质)**十分重要。

(6) 决策阶段：成功广告的最终作用是带来用户的**转化行为**，虽然这一阶段已经离开了广告的业务范围，但是好的广告还是能为转化率的提高做好铺垫的。

#### 1.2.2 互联网广告的技术特点

(1) **技术和计算导向**：数字媒体的特点使在线广告可以进行精细的受众定向，而技术又使得广告决策和交易朝着计算驱动的方向发展。

(2) **效果的可衡量性**：在不同的产品或时代中，点击率的比较并没有那么重要，而在一个特定时期不同广告和算法表现出来的差异才是更有意义的。

(3) **创意和投放方式的标准化**：标准化的驱动力来自于受众定向与程序化交易。既然需求方关心的是人群而非广告位，创意尺寸的统一化与一些关键接口的标准化非常关键。这些接口与标准中，比较典型的有视频广告的VAST标准和实时竞价的OpenRTB标准等。

(4) **媒体概念的多样化**：随着Web 2.0和移动互联的普及，被赋予了更多交互功能的互联网媒体与线下媒体有了本质差别。

(5) **数据驱动的投放策略**：与工业革命时期机器化的根本驱动力电力相类比，互联网的根本驱动力可以认为是数据的深入加工和利用。可以说，从来没有任何传统广告形式像在线广告那样，需要大规模地收集并利用数据，而这正是在线广告最吸引人之处。

### 1.3 计算广告的核心问题

Andrei Broder在提出计算广告这一课题的同时，也给出了其核心研究挑战：**Find the best match between a given user in a given context and a suitable advertisement**。结合近年来市场的发展以及实际业务中的而变化，该表述可以重新组织为：计算广告的核心问题，是为一系列用户与上下文的组合找到最合适的广告投放策略以优化整体广告活动的利润。

**广告活动的三个参与主体分别是广告(ad)、用户(user)和上下文(context)。广告展示的收入或成本与这三个因素都有关**。

#### 1.3.1 广告收入的分解

对一个广告市场中具体的产品形态，能够主动优化的往往是**收入**而非成本。首先分析在一次广告展示产生以后，有可能发生的后续行为：用户在媒体的广告位上看到广告以后，如果产生兴趣，首先产生的是点击行为，**广告点击与广告展现的比率称为点击率(click through rage, CTR)**；点击行为成功以后，将会打开广告主的**落地页(landing page)**，落地页成功打开次数与点击次数的比例称为**到达率**，这是在广告主的网站上发生的；如果用户从落地页进一步完成下单等操作，则称为**转化**，转化次数与到达次数的比例称为**转化率(conversion rate, CVR)**，这是在广告主网站或者线下发生的。按照媒体网站和广告主网站上的行为对广告收入$r$进行分解，是实践中合理且容易操作的方式：$\text{eCPM} = r(a,u,c)=μ(a,u,c)\times v(a, u, c)$。

其中$μ$表示**点击率**，$v$表示**点击价值**，即单次点击为广告主带来的收益。

该公式中，点击率描述的是发生在媒体上的行为，点击价值描述的是广告主站内的行为。而这两部分的乘积定量地表示了某次展示的eCPM。eCPM是计算广告中最关键的定量评估收益的指标。在对多个候选排序时，是根据eCPM还是CTR排序，也是区别广告产品和用户产品的重要策略特征。

eCPM一般指的是估计的**千次展示收益**，它有两个很相近的概念：如果讨论的是**千次展示收入**，往往用RPM；如果讨论的是**千次展示成本**，往往用CPM。

点击价值还可以进一步分解为**到达率、转化率和客单价的乘积**。这部分的深入解剖与行业密切相关，而且更多地属于站内运营而非广告的范畴。

#### 1.3.2 结算方式与eCPM估计的关系

对大多数广告产品来说，需要计算给定三元组$(a,u,c)$的eCPM以进行决策。可由于广告市场的协作关系复杂，**并非每个广告产品都可以对eCPM分解后的两个变量(点击率和点击价值)做出合理的估计**。根据eCPM的分解决定哪部分由谁来估计是广告市场各种计费模式产生的根本原因，也是广告市场中商业逻辑与产品架构衔接的关键一环。市场上主要的几种广告计费模式如下：

(1) **CPT(Cost Per Time)**：媒体将某个广告位以独占的方式交给某广告主，并按照独占的时间段收取费用的方式。严格来说，这是一种销售方式而非计费模式。

(2) **CPM(Cost Per Mille)**：按照**千次展示**结算。至于这些展示能否带来相应的收益，由需求方(广告主)来估计和控制其中的风险。

(3) **CPC(Cost Per Click)**：按**点击**结算。点击率的估计由供给方(媒体)完成(媒体可以通过其收集的大量用户行为数据相对准确地估计点击率)。点击价值的估计则由需求方完成(转化效果是广告主站内的行为，可以准确预估)，并通过出价的方式向市场通知自己的估价。

(4) **CPS(Cost Per Sale)/CPA(Cost Per Action)/ROI**：即按照销售订单、转化行为或投入产出比来结算，这些都是按照转化付费的一些变种。这是一种比较极端的结算方式，即需求方只按照最后的转化收益来结算，从而在最大程度上规避了风险。在这种结算方式下，供给方除了估计点击率，还要对点击价值作出估计，这样才能合理地决定流量分配。

(5) **oCPM(optimized CPM)**：广告平台仍然按照CPM结算费用，但会根据转化率进行优化。也就是说，虽然结算方式仍然是CPM，但是供给方会承担点击率和点击价值估计的任务。

综合来看，可以认为，对于效果广告，**CPC计费方式最有利于发挥供给方和需求方的长处**，因而在市场上被广泛接受；而对于品牌广告，由于效果和目的有时不便于直接衡量，可以考虑**按CPM的方式计费**；而CPS/CPA/ROI的计费方式，只在一些特定的环境下才比较合理。oCPM则是数据能里较强的广告平台向CPA方式的一种巧妙过渡。

### 1.4 推荐系统

推荐系统是一种**信息过滤系统**，根据用户的历史行为、社交关系、兴趣点，算法可以判断用户当前感兴趣的物品或内容。亚马逊CEO贝索斯说：如果我们有100万用户，我们将给他们100万个亚马逊网站。其可以大致分为三个阶段：(1) **数据源获取阶段**：item特征，用户画像，用户行为等；(2) **召回阶段**：粗筛，得到候选物品集；(3) **排序阶段**：对多个召回通道的内容进行打分排序，选出最优的少量结果。

在推荐算法方面，最早人们使用的是**基于内容的推荐方法(content-based filtering)**，根据物品的属性为他们打上标签，再通过这些标签计算他们之间的相似度。后期出现的协同过滤算法大大提高了推荐系统的性能，**协同过滤(collaborative filtering)**就是**通过数据找到与你相似的用户**，通过他们的行为和他们喜欢的内容。为你推荐你可能感兴趣的物品或内容。类似地，日常生活中，我们也会找到兴趣相同的朋友来帮我们推荐电影或者音乐。

机器学习可以看做使用数据来解决问题。在推荐系统中，使用的数据重在“相似度”，解决的问题在于“推荐”。其中，**数据可以是物品本身的，也可以是基于用户行为的**。

其中，content-based方法基于物品本身的内容，而不是用户购买/浏览物品的行为。基于用户行为的数据分为两种，(1) **显性反馈数据**：用户明确表示对物品的喜欢行为：**评分，喜欢，收藏，购买**等；(2) **隐性反馈数据**：不能明确反映用户喜好的行为：**浏览，停留时间，点击**等。

在协同过滤算法中，相似度的评判有两种基准：(1) **user-based**，即两个人共同喜欢的东西越多，那么**两个人就越相似**；(2) **item-based**，即两个物品共同喜欢的人越多，那么**两个物品就越相似**。因而产生了两种推荐模式：(1) **UserCF**，和你兴趣相投的用户，推荐他们喜欢的商品；(2) **ItemCF**，给用户推荐那些和他们之前喜欢的物品相似的物品。

**冷启动**指的是**当数据量比较少时应当如何推荐**的问题。其分为用户冷启动、物品冷启动及系统冷启动三种问题。**使用热门推荐**是一种常用的冷启动解决方法。

在推荐系统中，有一个有趣的问题：**exploit and expoire(利用与探索)**。例如：选餐厅，exploitation：去最喜欢的餐厅 / exploration：尝试新餐厅；浏览内容，exploitation：展示以往感兴趣的内容 / exploration: 展示多样性的内容；在线广告，exploitation：展示最好的广告 / exploration：展示些不同的广告。

推荐结果的**评价指标**有：用户满意度、预测准确度、覆盖率、多样性、新颖性、惊喜度、实时性、内容时效性、内容质量以及商业目标等。具体在实践中选用哪些评价指标，需要根据场景和需求进行决定。例如，**推荐场景**包括首页推荐、热门推荐、搜索后的推荐、购买后的推荐、关注了某个用户后的推荐等。

### 参考资料

[1] 刘鹏, 王超. 计算广告：互联网商业变现的市场与技术. 北京: 人民邮电出版社, 2019.

