## 数理基础6 线性规划

在一组线性等式或不等式的约束之下，求一个线性函数的最大值或最小值的问题，我们将这类问题称为**线性规划(linear programming, LP)**问题。

### 6.1 线性规划模型的三种形式

(1) 一般形式
$$
\begin{aligned}
&\min(\max) z=c_1x_1+\cdots+c_nx_n\\
s.t. \ \ &a_{i 1} x_{1}+a_{i 2} x_{2}+\cdots+a_{i n} x_{n}=b_{i}, \quad i=1, \cdots, p\\
&a_{i 1} x_{1}+a_{i 2} x_{2}+\cdots+a_{i n} x_{n} \geqslant b_{i}, \quad i=p+1, \cdots, s\\
&a_{i 1} x_{1}+a_{i 2} x_{2}+\cdots+a_{i n} x_{n} \leqslant b_{i}, \quad i=s+1, \cdots, m\\
&x_j \geqslant 0, \quad j=1, \cdots, q\\
&{x_j}_<^>0,j=q+1, \cdots, n
\end{aligned}
$$
其中，$z$为**目标函数**，$c=(c_1, \cdots, c_n)^T$为**价值向量**，其分量$c_j$为**价值系数**，$x_j$为**决策变量**，$a_{i j}$组成**系数矩阵**$A$，$b=(b_1, \cdots, b_m)^T$为**右端向量**；最下面两行分别为**非负约束**以及**自由变量(不限制取值的变量)**。

(2) 规范形式
$$
\begin{array}{l}
\min c^{T} x \\
s.t.\left\{\begin{array}{l}
A x \geqslant b \\
x \geqslant 0
\end{array}\right.
\end{array}
$$
(3) 标准形式
$$
\begin{array}{l}
\min c^{T} x \\
s.t.\left\{\begin{array}{l}
A x = b \\
x \geqslant 0
\end{array}\right.
\end{array}
$$

三种形式的LP问题全都是等价的，即一种形式的LP可以简单的变换为另一种形式的LP，且它们有相同的解。通常情况下，**仅考虑将一般形式化为规范形式和标准形式**。

### 6.2 一般形式转为规范形式

为了把一般形式的LP问题变换为规范形式，必须**消除等式约束和自由变量**。在一般形式的LP中，一个等式约束
$$
\sum_{j=1}^{n} a_{i j} x_{j}=b_{i}
$$
可以用以下两个不等式约束来代替：
$$
\sum_{j=1}^{n} a_{i j} x_{j} \geqslant b_{i} \quad \sum_{j=1}^{n}(-a_{i j}) x_{j} \geqslant (-b_{i})
$$
对于自由变量$x_j$，引入非负变量$x_j^+ \geqslant 0$和$x_j^- \geqslant 0$，并设$x_j=x_j^+-x_j^-$，这样便将一般形式的LP转为规范形式。

### 6.3 一般形式转为标准形式

为了把一般形式的LP问题变换为标准形式，必须**消除其不等式约束和自由变量**。对符号无限制变量的处理可按转为规范形式的方法进行，对于一个不等式约束
$$
\sum_{j=1}^{n} a_{i j} x_{j} \geqslant b_{i}
$$
可以引入一个**剩余变量**$s_i$，用
$$
\sum_{j=1}^{n} a_{i j} x_{j}-s_{i}=b_{i}, s_{i} \geqslant 0
$$
代替上述的不等式约束；对于一个不等式约束
$$
\sum_{j=1}^{n} a_{i j} x_{j} \leqslant b_{i}
$$
可以引入一个**松弛变量**$r_i$，用
$$
\sum_{j=1}^{n} a_{i j} x_{j}+r_{i}=b_{i}, r_{i} \geqslant 0
$$
代替上述的不等式约束。

对于自由变量$x_j$，引入非负变量$x_j^+ \geqslant 0$和$x_j^- \geqslant 0$，并设$x_j=x_j^+-x_j^-$，这样便将一般形式的LP转为标准形式。

### 6.4 线性规划问题的可行域

一个满足所有约束条件的向量$x=(x_1,x_2,\cdots,x_n)^T$称为LP问题的**可行解**或**可行点**。所有可行点组成的集合称为LP问题的可行区域，记为$D$。给定一个线性规划问题，下列三种情况必居其一：

(1) $D=\phi$，称该问题**无解**或**不可行**；

(2) $D \not = \phi$，但目标函数在$D$上无界，此时称该问题**无界**；

(3) $D \not = \phi$，且目标函数有有限的最优值，此时称该问题**有最优解**。有解的情况还分为**有唯一解**和**有无穷多解**。

求解一个线性规划问题就是要判断该问题属于哪种情况。当问题有最优解时，还需要在可行区域中求出使目标函数达到最小值的点，也就是**最优解**，以及目标函数的**最优值**。

##### 凸组合与凸集

设$x,y$是$n$维欧式空间中的两个点，$\lambda \in [0,1]$，则称$\lambda x + (1-\lambda) y$为$x$和$y$的**凸组合**。

设$x_1,x_2,\cdots,x_k$是$n$维欧式空间中的$k$个点，若存在$k$个介于0和1之间的数$a_1,\cdots,a_k$，其总和等于1，使得$x=a_1x_1+a_2x_2+\cdots+a_k x_k$，则称$x$为$x_1,x_2,\cdots,x_k$的**凸组合**。

设$S \subset \mathbb R^n$是$n$维欧式空间中的一个点集，若对任何$x \in S, y \in S$，都有$\lambda x + (1-\lambda) y \in S$，则称$S$为一个**凸集**。可以证明，任意多个凸集的交还是凸集。

设$S$为凸集，$x \in S$。若对任何$y \in S, z \in S, y \not = z$以及任何$0<\lambda<1$，都有：
$$
x \not = \lambda y + (1 - \lambda) z
$$
则称$x$为凸集$S$的一个**顶点(极点)**。

利用定义可以证明，线性规划问题的可行域$D=\{x \in \mathbb R^n|Ax=b, x\geqslant 0\}$是凸集。

定理：若线性规划问题**有两个不同的最优解**， 则线性规划问题**有无穷多个最优解**。

证明：设$x,y$是下列线性规划问题的**两个最优解**，最优值为$z_{min}$：
$$
\begin{array}{l}
\min c^{T} x \\
s.t.\left\{\begin{array}{l}
A x = b \\
x \geqslant 0
\end{array}\right.
\end{array}
$$
令$w=\lambda x + (1-\lambda)y$，其中$\lambda \in [0,1]$。由于线性规划问题的可行域$D$为凸集，因此$w \in D$。

$c^Tw=c^T(\lambda x + (1-\lambda)y)=\lambda c^Tx+(1-\lambda)c^Ty=z_{min}$，即$w$是最优解。由$\lambda$的任意性可得最优解有无穷多个。

##### 多面凸集与凸多面体

给定$b \in \mathbb R$及非零向量$a \in \mathbb R^n$，称集合$H=\{x \in \mathbb R^n|a^Tx=b\}$是$\mathbb R^n$中的一个超平面。超平面$H$是凸集，且由超平面$H$产生的两个**闭半空间**
$$
H^+=\{x \in \mathbb R^n|a^Tx \geqslant b\} \ \ \ \ H^-=\{x \in \mathbb R^n|a^Tx \leqslant b\}
$$
都是凸集。

由于凸集的交还是凸集，因而满足一组线性等式$a_i^Tx=b_i,i=1,\cdots,p$与另一组线性不等式$a_i^Tx \geqslant b_i,i=p+1,\cdots,p+q$的全体向量$x$的集合也是凸集。称
$$
S=\{x \in \mathbb R^n|a_i^Tx=b_i,i=1,\cdots,p;a_i^Tx \geqslant b_i,i=p+1,\cdots,p+q\}
$$
为**多面凸集**，非空有界的多面凸集称为**凸多面体**。

线性规划问题的可行域$D=\{x \in \mathbb R^n|Ax=b, x\geqslant 0\}$是凸多面体。

### 6.5 线性规划问题的最优解

#### 6.5.1 两个变量线性规划问题的图解法

图解法利用绘制可行域以及目标函数的方式来寻找目标函数的最优解，可以直观得到最优解的情况分为：

(1) 有**唯一**的最优解；

(2) 有**无穷多个**最优解；

(3) 有可行解但**无最优解**；

(4) **无可**行解；

四种情况。线性规划的可行区域$D$是**若干个半平面的交集**，它形成了一个**有界的或无界的凸多边形**。对于给定的线性规划问题，如果它有**最优解**，最优解总可以在$D$的**某个顶点上达到**。

#### 6.5.2 基可行解及线性规划基本定理

设线性规划问题标准形式的约束为$Ax=b$，其中$A \in \mathbb R^{m \times n}$，$B$是秩为$m$的约束矩阵$A$中的$m$阶满秩子方阵，则称$B$为一个**基(或基阵)**。$B$中$m$个线性无关的列向量称为**基向量**，变量$x$中与之对应的$m$个分量称为**基变量**，其余的分量称为**非基变量**。**令所有非基变量取值为零**，得到的解
$$
x=\left[\begin{array}{l}
x_B \\
x_{N}
\end{array}\right]=\left[\begin{array}{c}
B^{-1}b \\
0
\end{array}\right]
$$
称为相应于$B$的**基解**，当$B^{-1}b \geqslant 0$时，称基本解$x$为**基可行解**，这时对应的基$B$称为**可行基**。

可行解$\bar x$是基可行解的充要条件是它的正分量所对应的$A$中的**列向量线性无关**。

$\bar x$是**基可行解**的充要条件是$\bar x$是**可行域**$D$的**顶点**。

若一个LP问题的基可行解对应唯一的一个可行基，则称该基可行解是**非退化的**；否则，若基可行解可由不止一个可行基得到，则称该基可行解是**退化的**。

##### 线性规划的基本定理

(1) 一个标准形式的LP问题，若有可行解，则至少有一个基可行解。

(2) 若标准形式的LP问题有有限的最优值，则一定存在一个基可行解是最优解。即，**若标准形式的LP问题的目标函数有有限的最优值，则必可在某个基可行解处达到**。

以上两条定理被称为线性规划问题的基本定理。它告诉我们，求解标准形式的LP问题，只需**在基可行解的集合中进行搜索**(如果其目标函数有有限最优值的话)，而**基可行解的个数是有限的**。

线性规划问题的基本定理也可以用下面的定理代替：

(1) 若$K$是有界凸集，则$K$内任何一点$X$可表示为$K$的顶点的凸组合。

(2) **若可行域有界，则线性规划问题的目标函数一定可在其可行域的顶点上达到最优**。

### 6.6 线性规划问题的求解

单纯形法求解线性规划的思路：**一般线性规划问题具有线性方程组的变量数大于方程个数**，这时有不定的解。单纯形法是在高斯消去法的基础上，发展为求解变量数多于方程数，并且使目标函数值优化的方法。**从线性方程组中找出一个个的单纯形**，每一个单纯形可以求得一组解，然后再判断该解使函数值增大还是变小，决定下一步选择的单纯形，这就是迭代。算法在目标函数实现最大值或最小值时停止，这样就得到了最优解。

**单纯形**指零维中的点，一维中的线段，二维中的三角形，三维中的四面体，$n$维空间中有$n+1$个顶点的多面体。

考虑标准形式的LP问题
$$
\begin{array}{l}
\min c^{T} x \\
s.t.\left\{\begin{array}{l}
A x = b \\
x \geqslant 0
\end{array}\right.
\end{array}
$$
其中$x \in \mathbb R^n, c \in \mathbb R^n, b \in \mathbb R^m, A \in \mathbb R^{m \times n}$。如果它有最优解，则必可在某一基可行解处达到，因而**只需在基可行解集合中寻求即可**。

通常，假定可行域$D=\{x \in \mathbb R^n|Ax=b, x \geqslant 0\} \not = \phi$，$R(A)=m, m < n$，$B^{-1}b \geqslant 0$，且问题非退化。

单纯形算法的基本思路是，**先找一个基可行解**，判断它是否为最优解，如果不是，则转换到相邻的基可行解，再进行判断，如此迭代进行，**直到找到最优解，或者判定该问题无界**。该思路需要解决两个问题：

(1) 如何得到第一个基可行解：**大M法和两阶段法**。

(2) 如何判别和进行迭代：**单纯形法**。

#### 6.6.1 单纯形法

#### 

**利用单纯形表解决LP问题的步骤**：



#### 6.6.2 人工变量法

单纯形法需要**约束系数矩阵包含一个单位矩阵**，对应的变量指定为**初始基变量**。一般情况下，是不能保证这一点的，因此需要引入**人工变量法**，即添加人工变量构造出单位矩阵。值得注意的是，原约束的可行解和添加人工变量后的约束的可行解的关系如下：

(1) 原约束有可行解的情况下，原约束的任意一个可行解对应着变形后的约束的一个可行解；变形后的约束的可行解当**所有的人工变量都是0**的时候对应着原约束的可行解。

(2) 原约束无可行解的情况下，变形后的约束是总有可行解，没有办法用仅仅约束来控制。

求解带有人工变量的线性规划问题，通常有**大M法**和**两阶段法**两种方法。

##### 6.6.2.1 大M法

例如线性规划问题
$$
\begin{array}{l}
\max z=3x_1-x_2-2x_3 \\
\text {s.t.}\left\{\begin{array}{l}
3x_1+2x_2-3x_3=6 \\
x_1-2x_2+x_3=4 \\
x_1,x_2,x_3 \geqslant 0
\end{array}\right.
\end{array}
$$
约束矩阵中不包含单位向量，引入人工变量$x_4,x_5$：
$$
\begin{array}{l}
\max z=3x_1-x_2-2x_3-Mx_4-Mx_5 \\
\text {s.t.}\left\{\begin{array}{l}
3x_1+2x_2-3x_3+x_4=6 \\
x_1-2x_2+x_3+x_5=4 \\
x_1,x_2,x_3,x_4,x_5 \geqslant 0
\end{array}\right.
\end{array}
$$
大M法的思想是，**变形后的约束很容易找到一个可行基**：以$x_{n+1}, \cdots, x_{n+m}$为基变量，对应的$m \times m$矩阵为单位矩阵，$x_0=(0, \cdot, 0, b_1, \cdots, b_m)^T$为变形后约束的**初始基可行解**，以该可行解出发，**利用单纯形法求最优解**。

(1) **人工变量最终必须等于0才能保证原问题性质不变**。为保证人工变量为0，必须在$\max$问题的目标函数中令其系数为$-M$，在$\min$问题中令其系数为$M$。

(2) $M$为无限大的正数，这是一个惩罚项，**倘若人工变量不为零，则目标函数就永远达不到最优，所以必须将人工变量逐步从基变量中替换出去**。

(3) 如果最终表中的**人工变量仍没有置换出去**，那么当前问题**无可行解**。

(4) 检验数中含$M$符号的，当$M$的系数为正时，该检验数为正；当$M$的系数为负时，该检验数为负。

##### 6.6.2.2 两阶段法

用计算机处理数据时，只能用很大的数代替$M$，可能造成**计算机上的错误**，故多采用两阶段法。

(1) 第一阶段：在原线性规划问题中**加入人工变量**，构造如下模型
$$
\begin{array}{l}
\min w=x_{n+1}+\cdots+x_{n+m}+0 x_{1}+\cdots+0 x_{n} \\
\text {s.t.}\left\{\begin{array}{l}
a_{11}x_1+\cdots+a_{1n}x_n +x_{n+1} = b_1 \\
\ \ \ \ \vdots \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \vdots \ \ \ \ \ \ \\
a_{m1}x_1+\cdots+a_{m n}x_n+x_{n+m}=b_m\\
x_1, \cdots, x_{n+m} \geqslant 0
\end{array}\right.
\end{array}
$$
先求解如上线性规划问题，该问题的目标函数中质保函人工变量，即**令目标函数中其他变量的系数取0，人工变量的系数取某个正的常数(通常取1，如上所示)，在保持原问题约束条件不变的情况下求这个目标函数极小化的解**。显然在第一阶段中，当人工变量取值为0时，目标函数值也为0。这时候的最优解就是原线性规划问题的一个基可行解。如果第一阶段求解结果最优解的目标函数值不为0，也即最优解的基变量中含有非零的人工变量，表明**原线性规划问题无可行解**。

(2) 第二阶段：当第一阶段求解结果表明问题有可行解时，第二阶段是在原问题中**去除人工变量**，并从第一阶段的最优解出发，继续寻找问题的最优解。

### 6.7 线性规划问题的对偶理论



### 6.8 运输问题

#### 6.8.1 运输问题的数学模型

运输问题研究单一品种物资的运输调度问题，其典型情况是：设某种物品有$m$个产地$A_1, A_2, \cdots, A_m$，各产地的产量分别是$a_1, a_2, \cdots, a_m$；有$n$个销地$B_1, B_2, \cdots, B_n$，各销地的销量分别为$b_1, b_2, \cdots, b_n$。假定从产地$A_i$向销地$B_j$运输单位物品的运价是$c_{i j}$，问怎样调度这些物品才能使总运费最小。

#### 6.8.2 运输问题的初始基可行解



#### 6.8.3 解的最优性检验




### 参考资料

[1] 胡运权. 运筹学教程(第四版). 清华大学出版社, 2012.

[2] https://blog.csdn.net/cpluss/article/details/100806516

[3] https://zhuanlan.zhihu.com/p/61575249?from_voters_page=true